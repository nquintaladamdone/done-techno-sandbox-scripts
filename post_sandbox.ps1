# ===================================================================================================================
# We run as Admin ===================================================================================================
# ===================================================================================================================
if (!([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) { 
    Start-Process powershell.exe "-NoProfile -ExecutionPolicy Unrestricted -File `"$PSCommandPath`"" -Verb RunAs; 
    exit;
}

# ===================================================================================================================
# Validate the execution policy =====================================================================================
# ===================================================================================================================
$currentExecutionPolicy = Get-ExecutionPolicy

if ($currentExecutionPolicy -ne "Unrestricted") {
    Set-ExecutionPolicy Unrestricted -force
}

# ===================================================================================================================
# Install Node.js ===================================================================================================
# ===================================================================================================================
nvm install lts
nvm use lts

# ===================================================================================================================
# Install TypeScript ================================================================================================
# ===================================================================================================================
npm install typescript --g

# ===================================================================================================================
# Wait for user input ===============================================================================================
# ===================================================================================================================
Write-Host -NoNewLine 'Press any key to continue...';
$null = $Host.UI.RawUI.ReadKey('NoEcho,IncludeKeyDown');